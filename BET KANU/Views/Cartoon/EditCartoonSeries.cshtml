@model MangerVM

<!-- Data table css -->
<link href="~/plugins/datatable/dataTables.bootstrap4.min.css" rel="stylesheet" />
<link href="~/plugins/fileuploads/css/dropify.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="~/css/dashboard.css">


<head>
    @{
        ViewData["Title"] = "Edit";
    }
</head>

<div id="wrapper">
    <section class="bg-grey-500 promo">
        <div class="container">
            <h1 style="color:white"> &nbsp;Edit</h1>
        </div>
    </section>

    <section>
        @if (Model.product != null)
        {
            <div class="col-md-12">

                <div class="container">
                    <div class="col-12">
                        <form class="card" asp-action="EditCartoonSeries" enctype="multipart/form-data" method="post">
                            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                            <input type="hidden" asp-for="@Model.product.Id" />
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-lg-3 col-sm-12">
                                        <div class="form-group">
                                            <label asp-for="@Model.product.Title" class="control-label"></label>
                                            <input asp-for="@Model.product.Title" class="form-control" />
                                            <span asp-validation-for="@Model.product.Title"></span>
                                        </div>
                                        <div class="form-group">
                                            <label asp-for="@Model.product.Category" class="control-label"></label>
                                            @Html.DropDownListFor(m => m.product.Category, new SelectList(Enum.GetValues(typeof(Category))),new {@class = "form-control"})
                                            <span asp-validation-for="@Model.product.Category" class="text-danger"></span>
                                        </div>

                                        <div class="form-group">
                                            <label asp-for="@Model.product.TargetAudince" class="control-label"></label>
                                            @Html.DropDownListFor(m => m.product.TargetAudince, new SelectList(Enum.GetValues(typeof(Target))),new {@class = "form-control"})
                                            <span asp-validation-for="@Model.product.TargetAudince" class="text-danger"></span>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-sm-12">
                                        <div class="form-group">
                                            <label asp-for="@Model.product.SmallImage" class="control-label"></label>
                                            <input asp-for="@Model.SmallUrl" type="file" class="dropify" id="ImageUrl" name="SmallUrl" data-height='180' />
                                            <span asp-validation-for="@Model.product.SmallImage" class="text-danger"></span>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-sm-12">
                                        <div class="form-group">
                                            <label asp-for="@Model.product.CoverImage" class="control-label"></label>
                                            <div>
                                                <input asp-for="@Model.CoverUrl" type="file" class="dropify" id="ImageUrl2" name="CoverUrl" data-height='180' />
                                                <span asp-validation-for="@Model.product.CoverImage" class="text-danger"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body" style="color:white">
                                <div class="row">
                                    <div class="card">
                                        <div class="card-header">
                                            <h3 class="card-title"> Details</h3>
                                        </div>
                                        <!--START table-responsive -->
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered" style="width:100%">
                                                <tbody>
                                                    <tr>
                                                        <td>
                                                            <label asp-for="@Model.product.SubCategory" class="control-label"></label>
                                                        </td>
                                                        <td>
                                                            <input asp-for="@Model.product.SubCategory" class="form-control" />
                                                            <span asp-validation-for="@Model.product.SubCategory"></span>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <label asp-for="@Model.product.ReleaseDate" class="control-label"></label>
                                                        </td>
                                                        <td>
                                                            <input asp-for="@Model.product.ReleaseDate" class="form-control" />
                                                            <span asp-validation-for="@Model.product.ReleaseDate" class="text-danger"></span>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <label asp-for="@Model.product.LongDescription" class="control-label"></label>
                                                        </td>
                                                        <td>
                                                            <input asp-for="@Model.product.LongDescription" class="form-control" />
                                                            <span asp-validation-for="@Model.product.LongDescription"></span>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <label asp-for="@Model.product.ShortDescription" class="control-label"></label>
                                                        </td>
                                                        <td>
                                                            <input asp-for="@Model.product.ShortDescription" class="form-control" />
                                                            <span asp-validation-for="@Model.product.ShortDescription"></span>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <!--END table-responsive -->

                                    </div>
                                </div>
                                <div class="row text-center">
                                    <div class="col-md-4">
                                        <a asp-controller="Manger" asp-action="Index" class="btn btn-Create btn-shadow w-100">Back to List</a>
                                    </div>
                                    <div class="col-md-4">
                                        <a asp-action="CreateEpisode" asp-route-parentId="@Model.product.Id" class="btn btn-Create btn-shadow w-100">Add Episode</a>
                                    </div>
                                    <div class="col-md-4">
                                        <input type="submit" value="save" class="btn btn-Create btn-shadow w-100" />
                                    </div>
                                </div>
                            </div>
                  
                        
                        </form>
                        <div class="card">
                         
                                @if (Model.productEpisode != null)
                                {

                                    <div class="card-body" style="color:white">
                                        <div class="table-responsive">
                                            <table id="EditCarton" class="table table-striped table-bordered" style="width:100%">
                                                <thead>
                                                    <tr>
                                                        <th class="wd-15p" style="color:white">Title Episodes</th>
                                                        <th class="wd-15p" style="color:white">Video</th>
                                                        <th class="wd-20p " style="color:white">Title</th>
                                                        <th class="wd-20p " style="color:white">Status</th>
                                                        <th class="wd-10p" style="color:white">ReleaseDate Date</th>
                                                        <th class="wd-10p" style="color:white"></th>

                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @foreach (var episode in Model.productEpisode)
                                                    {
                                                        <tr>
                                                            <td>@Model?.product?.Title-Episodes</td>
                                                            <td><video src="@episode.VideoW"></video></td>
                                                            <td>@episode.Title</td>
                                                            <td>@episode.Status</td>
                                                            <td>@episode.ReleaseDate.Date</td>
                                                            <td>
                                                                <a class="btn btn-icon btn-info" asp-action="EditEpisode" asp-route-id="@episode.Id" asp-route-parentId="@Model?.product?.Id"><i class="fa-solid fa-pen-to-square"></i>Edit</a>

                                                                <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#staticBackdrop-@(episode.Id)">
                                                                    Delete
                                                                </button>
                                                                <!-- Modal -->
                                                                <div class="modal fade" id="staticBackdrop-@(episode.Id)" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                                                                    <div class="modal-dialog">
                                                                        <div class="modal-content">
                                                                            <div class="modal-header">
                                                                                <h1 class="modal-title fs-5" id="staticBackdropLabel">Delete</h1>
                                                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                            </div>
                                                                            <div class="modal-body">
                                                                                Are you sure you want to Delete This @episode.Title Episode ?
                                                                            </div>
                                                                            <div class="modal-footer">
                                                                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                                                                <form asp-action="DeleteEPpost" asp-controller="Cartoon" asp-route-id="@episode.Id" asp-route-parentId="@Model?.product?.Id" method="post">
                                                                                    <button type="submit" class="btn btn-danger">Delete</button>
                                                                                </form>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    }
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                }
                         
                        </div>
                    </div>
                </div>
            </div>
        }
    </section>
</div>

@section Scripts {
    <!-- Data tables -->
    <script src="https://cdn.datatables.net/v/dt/dt-1.13.5/datatables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.5/js/dataTables.bootstrap5.min.js"></script>
    <!-- Data table js -->
    <script>
        $(function (e) {
            $('#EditCarton').DataTable();
        });
    </script>
    @{
        <!-- file uploads js -->
        <script src="~/plugins/fileuploads/js/dropify.js"></script>
        <script>
            $('.dropify').dropify({
                messages: {
                    'default': 'Drag and drop a file here or click',
                    'replace': 'Drag and drop or click to replace',
                    'remove': 'Remove',
                    'error': 'Ooops, something wrong appended.'
                },
                error: {
                    'fileSize': 'The file size is too big (2M max).'
                }
            });
        </script>
        <script type="text/javascript">

            $(document).ready(function () {
                var source = document.getElementById("ImageURL").src;
                var source2 = document.getElementById("ImageURL2").src;
                var source3 = document.getElementById("ImageURL3").src;
                $(".dropify-render:eq(0)").find("img").remove();
                $(".dropify-preview:eq(0)").attr("Style", "Display:Block");
                $(".dropify-render:eq(0)").append("<img src=" + source + " height=\"100%\" />");
                $(".dropify-render:eq(1)").find("img").remove();
                $(".dropify-preview:eq(1)").attr("Style", "Display:Block");
                $(".dropify-render:eq(1)").append("<img src=" + source2 + " height=\"100%\" />");
                $(".dropify-render:eq(2)").find("img").remove();
                $(".dropify-preview:eq(2)").attr("Style", "Display:Block");
                $(".dropify-render:eq(2)").append("<img src=" + source3 + " height=\"100%\" />");
            });
        </script>

        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    }